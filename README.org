Efficient implementation of binary segmentation
